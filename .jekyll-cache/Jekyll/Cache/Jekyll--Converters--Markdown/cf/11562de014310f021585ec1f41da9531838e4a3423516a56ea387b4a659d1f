I"ô6<h2 id="clicommand-line-interface-applicationì´ë€">CLI(Command Line Interface) applicationì´ë€</h2>

<p>Textë¥¼ ì´ìš©í•˜ì—¬ í”„ë¡œê·¸ë¨ì— ëª…ë ¹(Command)ë¥¼ ë‚´ë ¤ ìƒí˜¸ì‘ìš©í•˜ëŠ” Application ë˜ëŠ” program<br />
CLI APPì„ ë§Œë“¤ê¸° ìœ„í•´ì„œëŠ” Textë¥¼ ì»¤ë§¨ë“œë¡œ ë°”ê¾¸ëŠ” Parsingì´ í•„ìš”í•˜ë‹¤.</p>

<h2 id="argparse">argparse</h2>

<p>pythonì—ì„œëŠ” clië¥¼ ë§Œë“¤ê¸° ìœ„í•œ parserë¥¼ ì œê³µí•˜ê³  ìˆë‹¤.<br />
argparse ëª¨ë“ˆì„ ì´ìš©í•˜ì—¬ cli appì„ ë§Œë“¤ ìˆ˜ ìˆì§€ë§Œ ì¢€ ë” ì§ê´€ì ì´ê³  ì‰¬ìš´ ë°©ë²•ì´ ìˆë‹¤.</p>

<h2 id="click">click</h2>

<p>clickíŒ¨í‚¤ì§€ë¥¼ ì´ìš©í•˜ë©´ ì‰½ê²Œ cli appì„ ë§Œë“¤ ìˆ˜ ìˆë‹¤. <a href="https://click.palletsprojects.com/en/7.x/" target="_blank">ê³µì‹ click í™ˆí˜ì´ì§€</a>ëŠ” click íŒ¨í‚¤ì§€ë¥¼ â€œCommand Line Interface Creation Kitâ€ë¼ê³  ì„¤ëª…í•˜ê³  ìˆë‹¤. íŒ¨í‚¤ì§€ì´ë¦„ì´ â€œclickâ€ì¸ ì´ìœ ì¸ ê²ƒ ê°™ë‹¤.</p>

<h3 id="1-virualenv-ì„¤ì •">1. virualenv ì„¤ì •</h3>

<p>í˜„ì¬ ìœˆë„ìš°ì—ì„œ WSLì„ ì‚¬ìš©ì¤‘ì´ë¯€ë¡œ <a href="https://docs.microsoft.com/ko-kr/windows/python/web-frameworks#install-python-pip-and-venv" target="_blank">í•´ë‹¹ê¸€</a>ì„ ì°¸ê³ í•˜ì—¬ ê°€ìƒí™˜ê²½ì„ ì„¤ì •í•œë‹¤.</p>

<h3 id="2-setuptoolsì„-ì´ìš©í•œ-ì„¤ì •">2. setuptoolsì„ ì´ìš©í•œ ì„¤ì •</h3>

<p>setuptoolsë¥¼ ì´ìš©í•˜ì—¬ scriptí™˜ê²½ì„ ì„¤ì •í•œë‹¤. click ê³µì‹ í™ˆí˜ì´ì§€ì— ë‚˜ì™€ ìˆëŠ” <a href="https://click.palletsprojects.com/en/7.x/setuptools/" target="_blank">ì„¤ëª…</a>ì„ ì˜ ë”°ë¼í•˜ë©´ ëœë‹¤.</p>

<p>setupì„ ì„¤ì •í•˜ì§€ ì•Šìœ¼ë©´ cli appì„ ì‹¤í–‰í•  ë•Œ, scriptì— <code class="language-plaintext highlighter-rouge">if __name__ =="__main__":</code>  suiteì•ˆì— <code class="language-plaintext highlighter-rouge">cli()</code>ë¥¼ í˜¸ì¶œí•´ì¤˜ì•¼ í•˜ë©° í„°ë¯¸ë„ì—ì„œ <code class="language-plaintext highlighter-rouge">python ì´ë¦„.py</code> ì´ëŸ° ì‹ìœ¼ë¡œ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•´ì•¼ í•œë‹¤.</p>

<p>ê·¸ ì™¸ì—ë„ click ê³µì‹ í™ˆí˜ì´ì§€ì— setuptoolë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ì´ìœ ë¥¼ 3ê°€ì§€ ì œì‹œí•˜ê³  ìˆë‹¤.</p>

<h3 id="3-command-ìƒì„±">3. command ìƒì„±</h3>

<p>clickì€ ê¸°ë³¸ì ìœ¼ë¡œ <a href="https://realpython.com/primer-on-python-decorators/" target="_blank">decorator</a>ë¥¼ ì´ìš©í•œë‹¤. ì´ëŠ” ì§ê´€ì ìœ¼ë¡œ cli appì„ ë§Œë“¤ ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">click</span>

<span class="c1"># command ìƒì„±
</span><span class="o">@</span><span class="n">click</span><span class="p">.</span><span class="n">commnad</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">cli</span><span class="p">():</span>
    <span class="k">pass</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">@click.command()</code> ë¥¼ ì´ìš©í•˜ì—¬ commnadë¥¼ ë°”ë¡œ ìƒì„±í•  ìˆ˜ ìˆë‹¤. ì´ ë•Œ def ì´ë¦„ì¸ cliê°€ commandì˜ ì´ë¦„ì´ ëœë‹¤.</p>

<p>shellì— cli â€“ helpë¥¼ ì…ë ¥í•˜ë©´ help ë©”ì‹œì§€ê°€ ë‚˜ì˜¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. commandë¥¼ ë§Œë“¤ë©´ clickì´ ìë™ìœ¼ë¡œ help ë©”ì‹œì§€ë¥¼ ì¶”ê°€í•´ì¤€ë‹¤.</p>

<h3 id="4-optionê³¼-argument-ìƒì„±">4. optionê³¼ argument ìƒì„±</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">click</span>

<span class="o">@</span><span class="n">click</span><span class="p">.</span><span class="n">command</span><span class="p">()</span>
<span class="o">@</span><span class="n">click</span><span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">'--msg'</span><span class="p">)</span> <span class="c1"># option ìƒì„±
</span><span class="k">def</span> <span class="nf">cli</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="n">click</span><span class="p">.</span><span class="n">echo</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</code></pre></div></div>

<p>ì˜µì…˜ì€ <code class="language-plaintext highlighter-rouge">@click.option()</code>ì„ ì´ìš©í•˜ì—¬ ë§Œë“¤ ìˆ˜ ìˆë‹¤. optionì€ optional argumentë¡œ commandì— ë°˜ë“œì‹œ í•„ìš”í•œ argumentëŠ” ì•„ë‹ˆë‹¤. optionì˜ ê°’ì„ <code class="language-plaintext highlighter-rouge">cli(msg)</code>ì—ì„œ ì˜µì…˜ì´ë¦„ê³¼ ë™ì¼í•œ ì´ë¦„(ì—¬ê¸°ì„œëŠ” <code class="language-plaintext highlighter-rouge">msg</code>, <code class="language-plaintext highlighter-rouge">--</code>ëŠ” ë¬´ì‹œëœë‹¤.)ì„ ê°€ì§„ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ë°›ì•„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. <code class="language-plaintext highlighter-rouge">click.echo()</code>ëŠ” <code class="language-plaintext highlighter-rouge">print()</code>ì™€ ê¸°ëŠ¥ì´ ê±°ì˜ ë˜‘ê°™ì€ë° ë” ë†’ì€ í˜¸í™˜ì„±ì„ ê°€ì§„ë‹¤.</p>

<p>shellì—ì„œ <code class="language-plaintext highlighter-rouge">cli --msg hello</code>ë¥¼ ì…ë ¥í•˜ë©´ <code class="language-plaintext highlighter-rouge">hello</code>ë¥¼ ì¶œë ¥í•œ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">click</span>

<span class="o">@</span><span class="n">click</span><span class="p">.</span><span class="n">command</span><span class="p">()</span>
<span class="o">@</span><span class="n">click</span><span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">'--msg'</span><span class="p">)</span>
<span class="o">@</span><span class="n">click</span><span class="p">.</span><span class="n">argument</span><span class="p">(</span><span class="s">'say'</span><span class="p">)</span> <span class="c1"># argumentì¶”ê°€
</span><span class="k">def</span> <span class="nf">cli</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span><span class="n">say</span><span class="p">):</span>
    <span class="n">click</span><span class="p">.</span><span class="n">echo</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="n">click</span><span class="p">.</span><span class="n">echo</span><span class="p">(</span><span class="n">say</span><span class="p">)</span>
</code></pre></div></div>

<p>ìœ„ ì™€ ê°™ì´ decoratorë¥¼ ì´ìš©í•˜ì—¬ optionê³¼ argumentë¥¼ ë™ì‹œì— ì¶”ê°€í•  ìˆ˜ ìˆë‹¤.</p>

<p>argumentëŠ” optionê³¼ëŠ” ë‹¤ë¥´ê²Œ commandì™€ í•¨ê»˜ ëª…ì‹œí•˜ì§€ ì•Šìœ¼ë©´ errorê°€ ë°œìƒí•œë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">cli hello --msg world</code> í•´ë‹¹ commandë¥¼ ì…ë ¥í•  ê²½ìš°, <code class="language-plaintext highlighter-rouge">say</code>ì—ëŠ” <code class="language-plaintext highlighter-rouge">hello</code>ê°€, <code class="language-plaintext highlighter-rouge">msg</code>ì—ëŠ” <code class="language-plaintext highlighter-rouge">world</code>ê°€ ê°ê° í• ë‹¹ëœë‹¤. í• ë‹¹ëœ ê°’ì„ <code class="language-plaintext highlighter-rouge">cli()</code> command ì•ˆì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>

<h3 id="5-ê¸°íƒ€-ìœ ìš©í•œ-ê¸°ëŠ¥">5. ê¸°íƒ€ ìœ ìš©í•œ ê¸°ëŠ¥</h3>

<p>clickì€ optionê³¼ argumentë¥¼ ì¶”ê°€í•˜ëŠ” ê²ƒì„ ë„˜ì–´ì„œ ê¸°íƒ€ ìœ ìš©í•œ ì˜µì…˜ì„ ì œê³µí•œë‹¤.</p>

<h4 id="nargs-type">nargs, type</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">@</span><span class="n">click</span><span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">'--num'</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">type</code>ì„ ì´ìš©í•˜ì—¬ ê°’ì˜ íƒ€ì…ì„ ì§€ì •í•  ìˆ˜ ìˆê³ , <code class="language-plaintext highlighter-rouge">nargs</code>ë¥¼ ì´ìš©í•˜ì—¬ userë¡œ ë¶€í„° ë„˜ê²¨ ë°›ëŠ” ê°’ì˜ ê°œìˆ˜ë¥¼ ì •í•  ìˆ˜ ìˆë‹¤. ì´ë•Œ ê°’ì€ tuple íƒ€ì…ìœ¼ë¡œ ì „ë‹¬ëœë‹¤.</p>

<h4 id="is_flag">is_flag</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">@</span><span class="n">click</span><span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">'--show'</span><span class="p">,</span> <span class="n">is_flag</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">cli</span><span class="p">(</span><span class="n">show</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span> 
        <span class="c1"># do something
</span></code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">is_flag</code> ê¸°ëŠ¥ì€ <code class="language-plaintext highlighter-rouge">show</code> ê°’ì´ bool íƒ€ì…ì„ ê°€ì§€ê²Œ í•œë‹¤.</p>

<p>íŠ¹ì • ê¸°ëŠ¥ì„ on/offí•˜ëŠ” ê²½ìš° ì‚¬ìš©ëœë‹¤.</p>

<h4 id="option-name">option name</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">@</span><span class="n">click</span><span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">'-v'</span><span class="p">,</span> <span class="s">'--verbose'</span><span class="p">)</span>
</code></pre></div></div>

<p>ì˜µì…˜ì´ë¦„ì„ í•œ ì•ŒíŒŒë²³ìœ¼ë¡œ ì¤„ì´ê³  ì‹¶ìœ¼ë©´ ìœ„ ì²˜ëŸ¼ ë‘ ê°œì˜ ì´ë¦„ ì¸ìë¥¼ ì£¼ë©´ ëœë‹¤.</p>

<h4 id="help-message">help message</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">@</span><span class="n">click</span><span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">'--msg'</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">"Type message)
</span></code></pre></div></div>

<p>ìœ„ì™€ ê°™ì´ help ë©”ì‹œì§€ë¥¼ ì§ì ‘ ì •í•  ìˆ˜ ìˆë‹¤.</p>

<h4 id="callback">callback</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">do_something</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="n">param</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
    <span class="c1"># do_something
</span>    <span class="n">ctx</span><span class="p">.</span><span class="nb">exit</span><span class="p">()</span>



<span class="o">@</span><span class="n">click</span><span class="p">.</span><span class="n">option</span><span class="p">(</span><span class="s">'--num'</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">do_something</span><span class="p">,</span> <span class="n">expose_value</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
<span class="k">def</span> <span class="nf">cli</span><span class="p">():</span>
    <span class="k">pass</span>
</code></pre></div></div>

<p>ì˜µì…˜ì— callbackí•¨ìˆ˜ë¥¼ ì£¼ë©´ ì»¨íŠ¸ë¡¤ì˜ íë¦„ì„ ë‹¤ë¥¸ í•¨ìˆ˜ë¡œ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤. ì´ë•Œ callbackí•¨ìˆ˜ëŠ” ìœ„ì™€ ê°™ì´ ì„¸ ê°œì˜ ì¸ìë¥¼ ë°›ì•„ì•¼ í•œë‹¤.</p>

<h4 id="prompt-confirm">prompt, confirm</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="o">@</span><span class="n">click</span><span class="p">.</span><span class="n">command</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">cli</span><span class="p">():</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">click</span><span class="p">.</span><span class="n">prompt</span><span class="p">(</span><span class="s">"Enter integer"</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
</code></pre></div></div>

<p>userë¡œë¶€í„° ê°’ì„ ì…ë ¥ë°›ìœ¼ë ¤ë©´ <code class="language-plaintext highlighter-rouge">click.prompt()</code>ë¥¼ ì´ìš©í•œë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="o">@</span><span class="n">click</span><span class="p">.</span><span class="n">command</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">cli</span><span class="p">():</span>
    <span class="n">click</span><span class="p">.</span><span class="n">confirm</span><span class="p">(</span><span class="s">"Are you sure?"</span><span class="p">)</span>
</code></pre></div></div>

<p>userì—ê²Œ confirmation messageë¥¼ ë³´ì—¬ì¤€ë‹¤. y/N(True or False)ê°’ì„ ê°€ì§„ë‹¤.</p>

<h4 id="group-command">group command</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">@</span><span class="n">click</span><span class="p">.</span><span class="n">group</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="o">@</span><span class="n">main</span><span class="p">.</span><span class="n">command</span><span class="p">():</span>
<span class="k">def</span> <span class="nf">sub</span><span class="p">():</span>
    <span class="k">pass</span>
</code></pre></div></div>

<p>main command ì•ˆì— sub commandë¥¼ ë‘˜ ìˆ˜ ìˆë‹¤. ë¨¼ì € main commandì— <code class="language-plaintext highlighter-rouge">@click.group()</code>ì„ ì£¼ê³  <code class="language-plaintext highlighter-rouge">@main.commnad()</code>ë¡œ sub commandë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤.</p>

<h2 id="ë„ì›€ì´-ë˜ëŠ”-ìë£Œ">ë„ì›€ì´ ë˜ëŠ” ìë£Œ</h2>

<ul>
  <li><a href="https://codeburst.io/building-beautiful-command-line-interfaces-with-python-26c7e1bb54df" target="_blank">Building Beautiful Command Line Interfaces with Python</a></li>
  <li><a href="https://www.youtube.com/watch?v=kNke39OZ2k0">Building Command Line Applications with Click</a></li>
  <li></li>
</ul>
:ET