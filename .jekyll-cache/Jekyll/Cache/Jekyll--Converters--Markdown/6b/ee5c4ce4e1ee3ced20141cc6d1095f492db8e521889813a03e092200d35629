I"‚ <h2 id="mongodb-data">Mongodb data</h2>

<h3 id="document">document</h3>

<p>mongodbì˜ ê¸°ë³¸ì ì¸ ë°ì´í„° ë‹¨ìœ„ëŠ” documentë‹¤. RBMSì˜ rowë¼ê³  ë³´ë©´ ëœë‹¤.</p>

<p>{â€œkeyâ€: value}ì˜ í˜•ì‹ì„ ê°€ì§€ê³  ìˆë‹¤. ìë°”ìŠ¤í¬ë¦½íŠ¸ ê°ì²´ì™€ ìœ ì‚¬í•˜ë‹¤.</p>

<p>documentì˜ keyì˜ íƒ€ì…ì€ stringì´ê¸° ë•Œë¬¸ì— â€œ â€œë¡œ ê°ì‹¸ì¤˜ì•¼ í•œë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">{"apple": "1"}</code>ê³¼ <code class="language-plaintext highlighter-rouge">{"apple": 1}</code>ì€ ì„œë¡œ ë‹¤ë¥¸ documentì´ë©°(Type-sensitive)</p>

<p><code class="language-plaintext highlighter-rouge">{"Apple": 1}</code>ê³¼ <code class="language-plaintext highlighter-rouge">{"apple": 1}</code>ì€ ì„œë¡œ ë‹¤ë¥´ë‹¤.(Case-sensitive)</p>

<h3 id="collection">collection</h3>

<p>documentì„ ëª¨ì€ ê²ƒì´ collectionì´ë‹¤. RDBMSì˜ tableì´ë¼ê³  ë³´ë©´ ëœë‹¤.</p>

<hr />

<h2 id="mongodb-crud">Mongodb CRUD</h2>

<p>ëª½ê³ ë””ë¹„ì—ì„œ ì‚¬ìš©í•˜ëŠ” CRUD methodsë¥¼ ë¨¼ì € ê°„ëµíˆ ì •ë¦¬í•œë‹¤.</p>

<h3 id="create">Create</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- db.collection.insert()
- db.collection.batchInsert()
</code></pre></div></div>

<h3 id="readquery">Read(query)</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- db.collection.find()
</code></pre></div></div>

<h3 id="update">Update</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- db.collection.update()
</code></pre></div></div>

<h3 id="delete">Delete</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- db.collection.remove()
- db.collection.drop()
</code></pre></div></div>

<hr />

<h2 id="create-method">CREATE method</h2>

<h3 id="dbcollectioninsertdocument">db.collection.insert(document)</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>db.fruit.insert({"apple": 2, "price": 4000})
</code></pre></div></div>

<p>insertì˜ ë§¤ê°œë³€ìˆ˜ë¡œ documentë¥¼ ë„˜ê²¨ì¤€ë‹¤. mongodbì˜ collectionì€ dynamic schemasë¥¼ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì—, ì¦‰ keyì˜ ì§‘í•©ì´ ê³ ì •ë˜ì–´ ìˆëŠ” ê²ƒì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì— documentì˜ ì‚½ì…ì´ ììœ ë¡­ë‹¤. nodejs í”„ë¡œê·¸ë˜ë°ì„ í•  ê²½ìš° mongooseë¥¼ í†µí•´ ì´ë¥¼ ë³´ì™„í•  ìˆ˜ ìˆë‹¤.</p>

<h3 id="dbcollectionbatchinsertarray">db.collection.batchInsert(array)</h3>

<p>ì—¬ëŸ¬ ê°œì˜ documentë¥¼ ì‚½ì…í•  ê²½ìš° batchInsert(ë°°ì—´)ë¥¼ ì‚¬ìš©í•œë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>db.fruit.batchInsert([{"banana":5}, {"mango":2}, {"orange":3}])
</code></pre></div></div>

<p>documentì˜ ë°°ì—´ì„ ë§¤ê°œë³€ìˆ˜ë¡œ ë„˜ê²¨ì£¼ë©´ ëœë‹¤.</p>

<h3 id="_id">_id</h3>

<p>mongodbëŠ” documentë¥¼ ì‚½ì…í•  ë•Œ ìë™ìœ¼ë¡œ <code class="language-plaintext highlighter-rouge">_id</code> key(or field)ë¥¼ ì¶”ê°€í•´ì„œ ì‚½ì…í•œë‹¤.</p>

<hr />

<h2 id="read-method">Read method</h2>

<h3 id="dbcollectionfindquery">db.collection.find(query)</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>db.fruit.find() // return all fruit's document
db.fruit.find({"apple": 2}) // return {"apple": 2, "price": 4000}
</code></pre></div></div>

<p>db.collection.find()ë¥¼ í†µí•´ documentë¥¼ ì½ì„ ìˆ˜ ìˆë‹¤. findì˜ ë§¤ê°œë³€ìˆ˜ì— ì•„ë¬´ ê²ƒë„ ë„˜ê¸°ì§€ ì•Šìœ¼ë©´ collectionì˜ ëª¨ë“  documentë¥¼ ë¦¬í„´í•œë‹¤.</p>

<p>ë§¤ê°œë³€ìˆ˜ë¡œëŠ” queryì˜ ê¸°ì¤€ì´ ë˜ëŠ” query documentë¥¼ ë°›ëŠ”ë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>db.collection.find({query1, query2, ..}) // query1 AND query2 AND ...
</code></pre></div></div>

<p>í•˜ë‚˜ì˜ query documentì— ì—¬ëŸ¬ ê°œì˜ queryë¥¼ ë°›ì„ ìˆ˜ ìˆëŠ”ë°, ì´ë•Œ queryëŠ” ANDë¡œ ë¬¶ì—¬ ê²€ìƒ‰ì„ ìˆ˜í–‰í•œë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>db.collection.find({}, {"key1": 1, "key2": 1}) 
// return {_"id": ObjectId(""), "key1": value1, "key2": value2}
</code></pre></div></div>

<p>íŠ¹ì • í‚¤ ê°’ë§Œ ë³´ê³  ì‹¶ì€ ê²½ìš° find()ì˜ ë‘ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜ë¡œ ì–´ë–¤ í‚¤ë¥¼ ë³´ê³  ì‹¶ì€ì§€ ì •í•  ìˆ˜ ìˆë‹¤.
ì—¬ê¸°ì„œ 1ì€ trueë¥¼ ì˜ë¯¸í•œë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>db.collection.find({}, {"key3": 0})
</code></pre></div></div>

<p>íŠ¹ì • í‚¤ë¥¼ ì œì™¸í•œ documentë¥¼ ë³´ê³  ì‹¶ì€ ê²½ìš° 0ì„ ë¶€ì—¬í•˜ë©´ ëœë‹¤. <strong>1ì€ í¬í•¨, 0ì€ ì œì™¸</strong></p>

<h3 id="query-conditional">Query conditional</h3>

<p>ë³µì¡í•œ ì¿¼ë¦¬ë¥¼ ë„ì™€ì¤„ operatorë“¤ì´ ì¡´ì¬í•œë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"$lt": less than
"$lte": less than or equal
"$gt": greater than
"$gte": greater than or equal
"$ne": not equal
</code></pre></div></div>

<p>ìœ„ ì—°ì‚°ìë¥¼ ì´ìš©í•˜ì—¬ ì¡°ê±´ ê²€ìƒ‰ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>db.collection.find({"age": {"$gte": 18, "$lte": 30}})
// "age"ê°€ 18ë³´ë‹¤ í¬ê±°ë‚˜ ê°™ìœ¼ë©° 30ë³´ë‹¤ ì‘ê±°ë‚˜ ê°™ì€ documentë¥¼ ë¦¬í„´í•œë‹¤.
db.collection.find({"name" : {"$ne": "joe"})
// name ê°’ì´ joeê°€ ì•„ë‹Œ documentë¥¼ ë¦¬í„´í•œë‹¤.
</code></pre></div></div>

<h3 id="or-query">OR query</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"$in": ì£¼ì–´ì§„ ì—¬ëŸ¬ ê°’ ì¤‘ í•˜ë‚˜ë¼ë„ ì¼ì¹˜í•˜ë©´ ë¦¬í„´í•œë‹¤.
"$or": ì£¼ì–´ì§„ ì¡°ê±´ ì¤‘ í•˜ë‚˜ë¼ë„ ì¼ì¹˜í•˜ë©´ ë¦¬í„´í•œë‹¤. 
</code></pre></div></div>

<p>ë‘ operatorëŠ” ë°°ì—´ê³¼ í•¨ê»˜ ì“°ì¸ë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>db.collection.find({"ticket_no", {"$in": [4, 2, 7, 10, 43, 28]}})
// ticket_noê°€ ì£¼ì–´ì§„ ê°’ ì¤‘ í•˜ë‚˜ë¼ë„ ì¼ì¹˜í•˜ëŠ” ê²½ìš° ê·¸ documentë¥¼ ë¦¬í„´
db.collection.fin({"$or": [{"name": "joe"}, {"age": {"$gt": 19}}]})
// nameì´ joeì´ê±°ë‚˜, ageê°€ 19ë³´ë‹¤ í° documentë¥¼ ë¦¬í„´
</code></pre></div></div>

<hr />

<h2 id="update-method">Update method</h2>

<h3 id="dbcollectionupdate">db.collection.update()</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>db.collection.update(query document, replacing document)
</code></pre></div></div>

<p>query documentë¡œ ì¼ì¹˜í•˜ëŠ” documentë¥¼ ì°¾ì€ ë’¤ replacing documentë¡œ ë°”ê¿”ë²„ë¦°ë‹¤. ì£¼ì˜í•´ì•¼í•  ê²ƒì€ íŠ¹ì • í•„ë“œë§Œ ë°”ê¾¸ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ documentìì²´ë¥¼ ë°”ê¿”ë²„ë¦°ë‹¤ëŠ” ê²ƒì´ë‹¤.(document replacement)</p>

<h3 id="update-modifiers">update modifiers</h3>

<p>íŠ¹ì • í•„ë“œë§Œ ë°”ê¾¸ê³  ì‹¶ì€ ê²½ìš° modifierë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.(ì—¬ê¸°ì„œ í•„ë“œëŠ” keyë¥¼ ë§í•œë‹¤.)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"$inc": íŠ¹ì • í•„ë“œì˜ ê°’ì„ ì¦ê°€ì‹œí‚¨ë‹¤. (number typeë§Œ ê°€ëŠ¥)
"$set": íŠ¹ì • í•„ë“œì˜ ê°’ì„ ë‹¤ë¥¸ ê°’ìœ¼ë¡œ ë°”ê¾¼ë‹¤.
"$unset": íŠ¹ì • í•„ë“œë¥¼ documentì—ì„œ ì§€ìš´ë‹¤.

db.collection.update({"domain": "naver"},{"page_views": {"$inc": 1}})
// domainì´ naverì¸ documentë¥¼ ì°¾ì•„ì„œ ê·¸ documentì˜ 
// page_views í•„ë“œì˜ ê°’ì„ 1 ì¦ê°€ì‹œí‚¨ë‹¤.

db.collection.update({"name": "james"}, {"$set: {"married": 1}})
// nameì´ jamesì¸ documentë¥¼ ì°¾ì•„ì„œ ê·¸ documentì˜ marriedê°’ì„ 1ë¡œ ë°”ê¾¼ë‹¤.

db.collection.update({"name": "joe"},{"$unset": {"book": 1}})
// nameì´ joeì¸ documentë¥¼ ì°¾ì•„ì„œ ê·¸ documentì˜ book í•„ë“œë¥¼ ì§€ìš´ë‹¤.
</code></pre></div></div>

<h3 id="upsert">upsert</h3>

<p>upsertëŠ” updateì™€ insertë¥¼ ìˆ˜í–‰í•˜ëŠ” ê²ƒì„ ë§í•œë‹¤.</p>

<p>updateì˜ ì²«ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜ì¸ query documentê°€ ì¼ì¹˜í•˜ëŠ” documentë¥¼ ì°¾ì§€ ëª»í•˜ë©´ query documentì™€ ë™ì¼í•œ documentë¥¼ insertí•˜ê³  updateë¥¼ ìˆ˜í–‰í•˜ëŠ” updateì˜ íŠ¹ìˆ˜í•œ í˜•íƒœë‹¤.</p>

<p>updateì˜ ì„¸ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜ë¡œ upsertë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.</p>

<hr />

<h2 id="delete-method">Delete method</h2>

<h3 id="dbcollectionremove">db.collection.remove()</h3>

<h3 id="dbcollectiondrop">db.collection.drop()</h3>
:ET